<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<!-- Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW) wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html -->
<title>Earthquake Scenario Map - Canada.ca</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta name="description" content=" " />
<link href="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/assets/favicon.ico" rel="icon" type="image/x-icon" />
<link rel="stylesheet" href="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/css/theme.min.css" />
<noscript><link rel="stylesheet" href="https://wet-boew.github.io/wet-boew/wet-boew/css/noscript.min.css" /></noscript><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-19T5RKNSMJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-19T5RKNSMJ');
</script>
<link href="/assets/fontawesome/css/all.min.css" rel="stylesheet">

</head>
<body class="wb-prettify all-pre" vocab="http://schema.org/" typeof="WebPage"><nav><ul id="wb-tphp">
	<li class="wb-slc"><a class="wb-sl" href="#wb-cont">Skip to main content</a></li></ul></nav>

<header>
	<div id="wb-bnr" class="container">
		<div class="row">
			<section id="wb-lng" class="col-xs-3 col-sm-12 pull-right text-right">
	<h2 class="wb-inv">Language selection</h2>
	<ul class="list-inline mrgn-bttm-0">
		<li>
			<a lang="fr" hreflang="fr" href="../fr/dsra_scenario_map.html">
				<span class="hidden-xs">Français</span>
				<abbr title="Français" class="visible-xs h3 mrgn-tp-sm mrgn-bttm-0 text-uppercase">fr</abbr>
			</a>
		</li>
	</ul>
</section>

			<div class="brand col-xs-9 col-sm-5 col-md-4" property="publisher" typeof="GovernmentOrganization">
	<a href="#" property="url">
		<img src="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/assets/sig-blk-en.svg" alt="Government of Canada" property="logo" /><span class="wb-inv"> / <span lang="fr">Gouvernement du Canada</span></span>
	</a>
	<meta property="name" content="Government of Canada">
	<meta property="areaServed" typeof="Country" content="Canada" />
	<link property="logo" href="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/assets/wmms-blk.svg" />
</div>

			
		</div>
	</div><nav id="wb-bc" property="breadcrumb">
	<h2>You are here:</h2>
	<div class="container"><div class="row">
		<ol class="breadcrumb">
			<!-- <li><a href="https://www.canada.ca/en.html">Canada.ca</a></li> -->
			<li><a href="https://www.github.com/OpenDRR/">OpenDRR</a></li>
			<li><a href="/data/en">OpenDRR Downloads</a></li>
			<li><a href="/en/">Earthquake Scenarios</a></li>
			<li><a href="/en/dsra_scenario_map">Earthquake Scenario Map</a></li>
		</ol>
	</div></div>
</nav>

</header>

<main class="container" property="mainContentOfPage" resource="#wb-main" typeof="WebPageElement">
<h1 id="wb-cont" property="name">Earthquake Scenario Map</h1>
<!-- Load Leaflet from CDN -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>

<!-- Load Esri Leaflet from CDN -->
<script src="https://unpkg.com/esri-leaflet@3.0.2/dist/esri-leaflet.js" integrity="sha512-myckXhaJsP7Q7MZva03Tfme/MSF5a6HC2xryjAM4FxPLHGqlh5VALCbywHnzs2uPoF/4G/QVXyYDDSkp5nPfig==" crossorigin=""></script>

<!-- Load Esri Leaflet Renderers plugin to use feature service symbology -->
<script src="https://unpkg.com/esri-leaflet-renderers@2.1.2" crossorigin=""></script>

<script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>

<link href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css" rel="stylesheet" />

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<link href="../assets/css/app.css" rel="stylesheet" />

<div id="map"></div>
<div id="sidebar"></div>

<div id="alert">Unable to load scenario</div>
<div id="scenarios">
  <h5>Available scenarios:</h5>
  <ul>
    
      <li><a href="?scenario=ACM7p3_LeechRiverFullFault"><small>Leech River Full Fault - Magnitude 7.3</small></a></li>
    
      <li><a href="?scenario=IDM7p1_Sidney"><small>Sidney - Magnitude 7.1</small></a></li>
    
      <li><a href="?scenario=SIM9p0_CascadiaInterfaceBestFault"><small>Cascadia Interface Best Fault - Magnitude 9.0</small></a></li>
    
  </ul>
</div>

<script>

  
  window['Sauid' + 'Desc'] = 'Settled Area ID';
  window['Sauid' + 'Detail'] = 'Unique identification code assiged to the Settled Area (SAUID), which represents the approximate footprint of permanent buildings within standard census dissemination areas (DAUID)';
  window['Sauid' + 'Format'] = Number('');
  
  window['sH_RupName' + 'Desc'] = 'Earthquake Scenario';
  window['sH_RupName' + 'Detail'] = 'Name of earthquake rupture scenario used to estimate damages and losses';
  window['sH_RupName' + 'Format'] = Number('');
  
  window['sH_RupAbbr' + 'Desc'] = 'Rupture Abbreviation';
  window['sH_RupAbbr' + 'Detail'] = 'Abbreviation for earthquake rupture scenario used to estimate damages and losses';
  window['sH_RupAbbr' + 'Format'] = Number('');
  
  window['sH_Source' + 'Desc'] = 'Source Type';
  window['sH_Source' + 'Detail'] = 'Representative earthquake source zone for rupture scenario';
  window['sH_Source' + 'Format'] = Number('');
  
  window['sH_Mag' + 'Desc'] = 'Moment Magnitude';
  window['sH_Mag' + 'Detail'] = 'Magnitude of earthquake rupture scenario';
  window['sH_Mag' + 'Format'] = Number('1');
  
  window['sH_HypoLon' + 'Desc'] = 'Hypocentre longitude';
  window['sH_HypoLon' + 'Detail'] = 'Degree of east-west longitude for earthquake hypocentre location';
  window['sH_HypoLon' + 'Format'] = Number('3');
  
  window['sH_HypoLat' + 'Desc'] = 'Hypocentre latitude';
  window['sH_HypoLat' + 'Detail'] = 'Degree of north-south latitude for earthquake hypocentre location';
  window['sH_HypoLat' + 'Format'] = Number('3');
  
  window['sH_HypoDepth' + 'Desc'] = 'Hypocentre depth';
  window['sH_HypoDepth' + 'Detail'] = 'Depth below ground surface to earthquake hypocentre';
  window['sH_HypoDepth' + 'Format'] = Number('2');
  
  window['sH_Rake' + 'Desc'] = 'Rupture Direction';
  window['sH_Rake' + 'Detail'] = 'Direction of slip along earthquake rupture surface measured relative to the fault strike (between -180 and 180 decimal degrees).  Convention follows Aki & Richards, [1980], where left lateral slip is 0, reverse slip is 90, normal slip is -90, and right lateral is positive or negative 180, respectively.';
  window['sH_Rake' + 'Format'] = Number('1');
  
  window['sH_GMPE' + 'Desc'] = 'Ground Motion Model';
  window['sH_GMPE' + 'Detail'] = 'Ground motion model set used for calculating propogation of seismic energy from earthquake rupture zone to a point on the earth\u0027s surface';
  window['sH_GMPE' + 'Format'] = Number('');
  
  window['sH_Rlz' + 'Desc'] = 'Branch Number';
  window['sH_Rlz' + 'Detail'] = 'Specific ground motion prediction equation or a mean value equivalent used for calculating ground motion values';
  window['sH_Rlz' + 'Format'] = Number('');
  
  window['sH_Wght' + 'Desc'] = 'Branch Weighting';
  window['sH_Wght' + 'Detail'] = 'Weight assigned to ground motion prediction equation for calculating mean ground motion values';
  window['sH_Wght' + 'Format'] = Number('');
  
  window['sH_SiteID' + 'Desc'] = 'Hazard Site ID';
  window['sH_SiteID' + 'Detail'] = 'Unique asset location identification used to sample Vs30 values for calculation of site amplification factor';
  window['sH_SiteID' + 'Format'] = Number('');
  
  window['sH_SiteLon' + 'Desc'] = 'Site Longitude';
  window['sH_SiteLon' + 'Detail'] = 'Degree of east-west longitude for SiteID';
  window['sH_SiteLon' + 'Format'] = Number('3');
  
  window['sH_SiteLat' + 'Desc'] = 'Site Latitude';
  window['sH_SiteLat' + 'Detail'] = 'Degree of north-south latitude for SiteID';
  window['sH_SiteLat' + 'Format'] = Number('3');
  
  window['sH_Vs30' + 'Desc'] = 'Shear Wave Velocity at 30 meters';
  window['sH_Vs30' + 'Detail'] = 'Average shear-wave velocity, in m/s, in the top 30m of soil/rock.';
  window['sH_Vs30' + 'Format'] = Number('111');
  
  window['sH_z1p0' + 'Desc'] = 'Depth to 1 km/s Shear Wave Velocity';
  window['sH_z1p0' + 'Detail'] = 'Depth to a shear-wave velocity of 1 km/s';
  window['sH_z1p0' + 'Format'] = Number('2');
  
  window['sH_z2p5' + 'Desc'] = 'Depth to 2.5 km/s Shear Wave Velocity';
  window['sH_z2p5' + 'Detail'] = 'Depth to a shear-wave velocity of 2.5 km/s';
  window['sH_z2p5' + 'Format'] = Number('2');
  
  window['sH_PGA' + 'Desc'] = 'Peak Ground Acceleration';
  window['sH_PGA' + 'Detail'] = 'Expected peak ground acceleration (PGA) for the earthquake scenario';
  window['sH_PGA' + 'Format'] = Number('2');
  
  window['sH_Sa0p1' + 'Desc'] = 'Spectral Acceleration (0.1s)';
  window['sH_Sa0p1' + 'Detail'] = 'Expected spectral acceleration at 0.1 seconds (SA0.1) for the earthquake scenario';
  window['sH_Sa0p1' + 'Format'] = Number('2');
  
  window['sH_Sa0p2' + 'Desc'] = 'Spectral Acceleration (0.2s)';
  window['sH_Sa0p2' + 'Detail'] = 'Expected spectral acceleration at 0.2 seconds (SA0.2) for the earthquake scenario';
  window['sH_Sa0p2' + 'Format'] = Number('2');
  
  window['sH_Sa0p3' + 'Desc'] = 'Spectral Acceleration (0.3s)';
  window['sH_Sa0p3' + 'Detail'] = 'Expected spectral acceleration at 0.3 seconds (SA0.3) for the earthquake scenario';
  window['sH_Sa0p3' + 'Format'] = Number('2');
  
  window['sH_Sa0p5' + 'Desc'] = 'Spectral Acceleration (0.5s)';
  window['sH_Sa0p5' + 'Detail'] = 'Expected spectral acceleration at 0.5 seconds (SA0.5) for the earthquake scenario';
  window['sH_Sa0p5' + 'Format'] = Number('2');
  
  window['sH_Sa0p6' + 'Desc'] = 'Spectral Acceleration (0.6s)';
  window['sH_Sa0p6' + 'Detail'] = 'Expected spectral acceleration at 0.6 seconds (SA0.6) for the earthquake scenario';
  window['sH_Sa0p6' + 'Format'] = Number('2');
  
  window['sH_Sa1p0' + 'Desc'] = 'Spectral Acceleration (1.0s)';
  window['sH_Sa1p0' + 'Detail'] = 'Expected spectral acceleration at 1 seconds (SA1.0) for the earthquake scenario';
  window['sH_Sa1p0' + 'Format'] = Number('2');
  
  window['sH_Sa2p0' + 'Desc'] = 'Spectral Acceleration (2.0s)';
  window['sH_Sa2p0' + 'Detail'] = 'Expected spectral acceleration at 2 seconds (SA2.0) for the earthquake scenario';
  window['sH_Sa2p0' + 'Format'] = Number('2');
  
  window['sH_MMI' + 'Desc'] = 'Modified Mercalli Index Value';
  window['sH_MMI' + 'Detail'] = 'Modified Mercalli Index, based on the Peak Ground Acceleration using the relations of Caprio et al., 2015';
  window['sH_MMI' + 'Format'] = Number('');
  
  window['sDt_None' + 'Desc'] = 'No Damage';
  window['sDt_None' + 'Detail'] = 'Expected number of undamaged buildings for the earthquake scenario';
  window['sDt_None' + 'Format'] = Number('111');
  
  window['sDtr_None' + 'Desc'] = 'No Damage Probability';
  window['sDtr_None' + 'Detail'] = 'Probability of no damage to buildings for the earthquake scenario';
  window['sDtr_None' + 'Format'] = Number('2');
  
  window['sDt_Slight' + 'Desc'] = 'Slight Damage';
  window['sDt_Slight' + 'Detail'] = 'Expected number of buildings likely to sustain slight damage for the earthquake scenario';
  window['sDt_Slight' + 'Format'] = Number('111');
  
  window['sDtr_Slight' + 'Desc'] = 'Slight Damage Ratio Probability';
  window['sDtr_Slight' + 'Detail'] = 'Probability of slight damage to buildings for the earthquake scenario';
  window['sDtr_Slight' + 'Format'] = Number('2');
  
  window['sDt_Moderate' + 'Desc'] = 'Moderate Damage';
  window['sDt_Moderate' + 'Detail'] = 'Expected number of buildings likely to sustain moderate damage for the earthquake scenario';
  window['sDt_Moderate' + 'Format'] = Number('111');
  
  window['sDtr_Moderate' + 'Desc'] = 'Moderate Damage Ratio Probability';
  window['sDtr_Moderate' + 'Detail'] = 'Probability of moderate damage to buildings for the earthquake scenario';
  window['sDtr_Moderate' + 'Format'] = Number('2');
  
  window['sDt_Extensive' + 'Desc'] = 'Extensive Damage';
  window['sDt_Extensive' + 'Detail'] = 'Expected number of buildings likely to sustain extensive damage for the earthquake scenario';
  window['sDt_Extensive' + 'Format'] = Number('111');
  
  window['sDtr_Extensive' + 'Desc'] = 'Extensive Damage Ratio Probability';
  window['sDtr_Extensive' + 'Detail'] = 'Probability of extensive damage to buildings for the earthquake scenario';
  window['sDtr_Extensive' + 'Format'] = Number('2');
  
  window['sDt_Complete' + 'Desc'] = 'Complete Damage';
  window['sDt_Complete' + 'Detail'] = 'Expected number of buildings likely to sustain complete damage for the earthquake scenario';
  window['sDt_Complete' + 'Format'] = Number('111');
  
  window['sDtr_Complete' + 'Desc'] = 'Complete Damage Ratio Probability';
  window['sDtr_Complete' + 'Detail'] = 'Probability of complete damage to buildings for the earthquake scenario';
  window['sDtr_Complete' + 'Format'] = Number('2');
  
  window['sDt_Collapse' + 'Desc'] = 'Collapsed Buildings';
  window['sDt_Collapse' + 'Detail'] = 'Expected number of collapsed buildings for the earthquake scenario';
  window['sDt_Collapse' + 'Format'] = Number('111');
  
  window['sDtr_Collapse' + 'Desc'] = 'Collapse Ratio Probability';
  window['sDtr_Collapse' + 'Detail'] = 'Probability of building collapsed buildings for the earthquake scenario';
  window['sDtr_Collapse' + 'Format'] = Number('2');
  
  window['SCm_Interruption' + 'Desc'] = 'Building Downtime';
  window['SCm_Interruption' + 'Detail'] = 'Average expected duration of time that a building is not functional for habitation or business operations for the earthquake scenario';
  window['SCm_Interruption' + 'Format'] = Number('2');
  
  window['sCm_Repair' + 'Desc'] = 'Repair Time';
  window['sCm_Repair' + 'Detail'] = 'Average expected duration of time required for cleanup, permitting, construction and repair of building damage sustained for the earthquake scenario';
  window['sCm_Repair' + 'Format'] = Number('2');
  
  window['SCm_Recovery' + 'Desc'] = 'Recovery Time';
  window['SCm_Recovery' + 'Detail'] = 'Average expected time required to recover pre-event (baseline) levels of building functionality for the earthquake scenario, including initial downtime and time for cleanup, construction and repair of building damage';
  window['SCm_Recovery' + 'Format'] = Number('2');
  
  window['sCt_DebrisTotal' + 'Desc'] = 'Total Disaster Debris';
  window['sCt_DebrisTotal' + 'Detail'] = 'Expected volume of disaster debris (wood and brick + concrete and steel) generated as a result of building damage in the earthquake scenario';
  window['sCt_DebrisTotal' + 'Format'] = Number('2');
  
  window['sCt_DebrisBW' + 'Desc'] = 'Wood and Brick Debris';
  window['sCt_DebrisBW' + 'Detail'] = 'Expected volume of wood and brick disaster debris generated as a result of building damage in the earthquake scenario';
  window['sCt_DebrisBW' + 'Format'] = Number('2');
  
  window['sCt_DebrisCS' + 'Desc'] = 'Concrete and Steel Debris';
  window['sCt_DebrisCS' + 'Detail'] = 'Expected volume of concrete and steel disaster debris generated as a result of building damage in the earthquake scenario';
  window['sCt_DebrisCS' + 'Format'] = Number('2');
  
  window['sCt_CasDayL1' + 'Desc'] = 'Minor Injury (Daytime)';
  window['sCt_CasDayL1' + 'Detail'] = 'Number of persons expected to suffer basic first-aid treatment (Severity Level 1) in the earthquake scenario should it occur during daytime hours  (09:00-17:00)';
  window['sCt_CasDayL1' + 'Format'] = Number('111');
  
  window['sCt_CasDayL2' + 'Desc'] = 'Moderate Injury (Daytime)';
  window['sCt_CasDayL2' + 'Detail'] = 'Number of persons expected to suffer non-life-threatening injuries requiring specialized medical treatment (Severity Level 2) in the earthquake scenario should it occur during daytime hours  (09:00-17:00)';
  window['sCt_CasDayL2' + 'Format'] = Number('111');
  
  window['sCt_CasDayL3' + 'Desc'] = 'Serious Injury (Daytime)';
  window['sCt_CasDayL3' + 'Detail'] = 'Number of persons expected to suffer life-threatening injuries requiring hospital admissions (Severity Level 3) in the earthquake scenario should it occur during daytime hours (09:00-17:00)';
  window['sCt_CasDayL3' + 'Format'] = Number('111');
  
  window['sCt_CasDayL4' + 'Desc'] = 'Critical Injury (Daytime)';
  window['sCt_CasDayL4' + 'Detail'] = 'Number of expected fatalities resulting from complete building damage and/or collapse (Severity Level 4) in the earthquake scenario should it occur during daytime hours (09:00-17:00)';
  window['sCt_CasDayL4' + 'Format'] = Number('111');
  
  window['sCt_CasNightL1' + 'Desc'] = 'Minor Injury (Nighttime)';
  window['sCt_CasNightL1' + 'Detail'] = 'Number of persons expected to suffer basic first-aid treatment (Severity Level 1) in the earthquake scenario should it occur during nighttime hours (20:00-06:00)';
  window['sCt_CasNightL1' + 'Format'] = Number('111');
  
  window['sCt_CasNightL2' + 'Desc'] = 'Moderate Injury (Nighttime)';
  window['sCt_CasNightL2' + 'Detail'] = 'Number of persons expected to suffer non-life-threatening injuries requiring specialized medical treatment (Severity Level 2) in the earthquake scenario should it occur during nighttime hours (20:00-06:00)';
  window['sCt_CasNightL2' + 'Format'] = Number('111');
  
  window['sCt_CasNightL3' + 'Desc'] = 'Serious Injury (Nighttime)';
  window['sCt_CasNightL3' + 'Detail'] = 'Number of persons expected to suffer life-threatening injuries requiring hospital admissions (Severity Level 3) in the earthquake scenario should it occur during nighttime hours (20:00-06:00)';
  window['sCt_CasNightL3' + 'Format'] = Number('111');
  
  window['sCt_CasNightL4' + 'Desc'] = 'Critical Injury (Nighttime)';
  window['sCt_CasNightL4' + 'Detail'] = 'Number of expected fatalities resulting from complete building damage and/or collapse (Severity Level 4) in the earthquake scenario should it occur during nighttime hours (20:00-06:00)';
  window['sCt_CasNightL4' + 'Format'] = Number('111');
  
  window['sCt_CasTransitL1' + 'Desc'] = 'Minor Injury (In Transit)';
  window['sCt_CasTransitL1' + 'Detail'] = 'Number of persons expected to suffer basic first-aid treatment (Severity Level 1) in the earthquake scenario should it occur during morning and evening commute hours (06:00-09:00 and 17:00-20:00)';
  window['sCt_CasTransitL1' + 'Format'] = Number('111');
  
  window['sCt_CasTransitL2' + 'Desc'] = 'Moderate Injury (In Transit)';
  window['sCt_CasTransitL2' + 'Detail'] = 'Number of persons expected to suffer non-life-threatening injuries requiring specialized medical treatment (Severity Level 2) in the earthquake scenario should it occur during morning and evening commute hours (06:00-09:00 and 17:00-20:00)';
  window['sCt_CasTransitL2' + 'Format'] = Number('111');
  
  window['sCt_CasTransitL3' + 'Desc'] = 'Serious Injury (In Transit)';
  window['sCt_CasTransitL3' + 'Detail'] = 'Number of persons expected to suffer life-threatening injuries requiring hospital admissions (Severity Level 3) in the earthquake scenario should it occur during morning and evening commute hours (06:00-09:00 and 17:00-20:00)';
  window['sCt_CasTransitL3' + 'Format'] = Number('111');
  
  window['sCt_CasTransitL4' + 'Desc'] = 'Critical Injury (In Transit)';
  window['sCt_CasTransitL4' + 'Detail'] = 'Number of expected fatalities resulting from complete building damage and/or collapse (Severity Level 4) in the earthquake scenario should it occur during morning and evening commute hours (06:00-09:00 and 17:00-20:00)';
  window['sCt_CasTransitL4' + 'Format'] = Number('111');
  
  window['sCt_Shelter' + 'Desc'] = 'Emergency Shelter Requirement';
  window['sCt_Shelter' + 'Detail'] = 'Expected number of people requiring short-term emergency shelter for the earthquake scenario';
  window['sCt_Shelter' + 'Format'] = Number('111');
  
  window['sCt_Res3' + 'Desc'] = 'Residents Disrupted after 3 Days';
  window['sCt_Res3' + 'Detail'] = 'Expected number of people to be displaced for up to 3 days for the earthquake scenario as a result of building damage';
  window['sCt_Res3' + 'Format'] = Number('111');
  
  window['sCt_Res30' + 'Desc'] = 'Residents Disrupted after 30 Days';
  window['sCt_Res30' + 'Detail'] = 'Expected number of people to be displaced for up to 30 days for the earthquake scenario as a result of building damage';
  window['sCt_Res30' + 'Format'] = Number('111');
  
  window['sCt_Res90' + 'Desc'] = 'Residents Affected after 90 Days';
  window['sCt_Res90' + 'Detail'] = 'Expected number of people to be displaced for up to 90 days for the earthquake scenario as a result of building damage';
  window['sCt_Res90' + 'Format'] = Number('111');
  
  window['sCr_Res90' + 'Desc'] = '90-Day Residential Affected';
  window['sCr_Res90' + 'Detail'] = 'Proportion of nighttime population expected to be displaced for up to 90 days for the earthquake scenario as a result of building damage (sCt_DisplRes90 / Et_PopNight)';
  window['sCr_Res90' + 'Format'] = Number('2');
  
  window['sCt_Res180' + 'Desc'] = 'Residents Disrupted after 180 Days';
  window['sCt_Res180' + 'Detail'] = 'Expected number of people to be displaced for up to 180 days for the earthquake scenario as a result of building damage';
  window['sCt_Res180' + 'Format'] = Number('111');
  
  window['sCt_Res360' + 'Desc'] = 'Residents Disrupted after 360 Days';
  window['sCt_Res360' + 'Detail'] = 'Expected number of people to be displaced for up to 360 days for the earthquake scenario as a result of building damage';
  window['sCt_Res360' + 'Format'] = Number('111');
  
  window['sCt_Hshld' + 'Desc'] = 'Displaced Households after 3 Days';
  window['sCt_Hshld' + 'Detail'] = 'Expected number of households to be displaced for the earthquake scenario as a result of building damage';
  window['sCt_Hshld' + 'Format'] = Number('111');
  
  window['sCt_Hshld3' + 'Desc'] = 'Displaced Households after 3 Days';
  window['sCt_Hshld3' + 'Detail'] = 'Expected number of households to be displaced for up to 3 days for the earthquake scenario as a result of building damage';
  window['sCt_Hshld3' + 'Format'] = Number('111');
  
  window['sCt_Hshld30' + 'Desc'] = 'Displaced Households after 30 Days';
  window['sCt_Hshld30' + 'Detail'] = 'Expected number of households to be displaced for up to 30 days for the earthquake scenario as a result of building damage';
  window['sCt_Hshld30' + 'Format'] = Number('111');
  
  window['sCt_Hshld90' + 'Desc'] = 'Displaced Households after 90 Days';
  window['sCt_Hshld90' + 'Detail'] = 'Expected number of households to be displaced for up to 90 days for the earthquake scenario as a result of building damage';
  window['sCt_Hshld90' + 'Format'] = Number('111');
  
  window['sCr_Hshld90' + 'Desc'] = '90-Day Household Displacement';
  window['sCr_Hshld90' + 'Detail'] = 'Proportion of households expected to be displaced for up to 90 days for the earthquake scenario as a result of building damage (sCt_DisplHshld90 / Et_SFHshld+Et_MFHshld)';
  window['sCr_Hshld90' + 'Format'] = Number('2');
  
  window['sCt_Hshld180' + 'Desc'] = 'Displaced Households after 180 Days';
  window['sCt_Hshld180' + 'Detail'] = 'Expected number of households to be displaced for up to 180 days for the earthquake scenario as a result of building damage';
  window['sCt_Hshld180' + 'Format'] = Number('111');
  
  window['sCt_Hshld360' + 'Desc'] = 'Displaced Households after 360 Days';
  window['sCt_Hshld360' + 'Detail'] = 'Expected number of households to be displaced for up to 360 days for the earthquake scenario as a result of building damage';
  window['sCt_Hshld360' + 'Format'] = Number('111');
  
  window['sCt_Empl30' + 'Desc'] = 'Employees Displaced after 30 Days';
  window['sCt_Empl30' + 'Detail'] = 'Expected number of employees affected for up to 30 days by business interruption caused by building damage in the earthquake scenario';
  window['sCt_Empl30' + 'Format'] = Number('111');
  
  window['sCt_Empl90' + 'Desc'] = 'Employees Displaced after 90 Days';
  window['sCt_Empl90' + 'Detail'] = 'Expected number of employees affected for up to 90 days by business interruption caused by building damage in the earthquake scenario';
  window['sCt_Empl90' + 'Format'] = Number('111');
  
  window['sCr_Empl90' + 'Desc'] = '90-Day Employee Displacement';
  window['sCr_Empl90' + 'Detail'] = 'Proportion of employees expected to be affected for up to 90 days by business interruption caused by building damage in the earthquake scenario (sCt_DisrupEmpl90 / Et_PopDay)';
  window['sCr_Empl90' + 'Format'] = Number('2');
  
  window['sCt_Empl180' + 'Desc'] = 'Employees Displaced after 180 Days';
  window['sCt_Empl180' + 'Detail'] = 'Expected number of employees affected for up to 180 days by business interruption caused by building damage in the earthquake scenario';
  window['sCt_Empl180' + 'Format'] = Number('111');
  
  window['sCt_Empl360' + 'Desc'] = 'Employees Displaced after 360 Days';
  window['sCt_Empl360' + 'Detail'] = 'Expected number of employees affected for up to 360 days by business interruption caused by building damage in the earthquake scenario';
  window['sCt_Empl360' + 'Format'] = Number('111');
  
  window['sLt_Asset' + 'Desc'] = 'Asset Loss';
  window['sLt_Asset' + 'Detail'] = 'Expected total capital asset loss to buildings and contents for a specific earthquake rupture scenario';
  window['sLt_Asset' + 'Format'] = Number('444');
  
  window['sLm_Asset' + 'Desc'] = 'Asset Loss Ratio';
  window['sLm_Asset' + 'Detail'] = 'Average capital asset loss ratio for buildings and contents for the earthquake scenario';
  window['sLm_Asset' + 'Format'] = Number('2');
  
  window['sLt_Bldg' + 'Desc'] = 'Building Loss';
  window['sLt_Bldg' + 'Detail'] = 'Expected total loss from building damage for the earthquake scenario';
  window['sLt_Bldg' + 'Format'] = Number('444');
  
  window['sLmr_Bldg' + 'Desc'] = 'Building Loss Ratio';
  window['sLmr_Bldg' + 'Detail'] = 'Average loss ratio for buildings in the earthquake scenario';
  window['sLmr_Bldg' + 'Format'] = Number('2');
  
  window['sLt_Str' + 'Desc'] = 'Structural Loss';
  window['sLt_Str' + 'Detail'] = 'Expected total loss to structural components of a building  for the earthquake scenario';
  window['sLt_Str' + 'Format'] = Number('444');
  
  window['sLt_NStr' + 'Desc'] = 'Nonstructural Loss';
  window['sLt_NStr' + 'Detail'] = 'Expected total loss to non structural components of a building for the earthquake scenario';
  window['sLt_NStr' + 'Format'] = Number('444');
  
  window['sLt_Cont' + 'Desc'] = 'Content Loss';
  window['sLt_Cont' + 'Detail'] = 'Expected total loss to building contents for the earthquake scenario';
  window['sLt_Cont' + 'Format'] = Number('444');
  
  window['pruid' + 'Desc'] = 'Province or Territory ID';
  window['pruid' + 'Detail'] = 'Unique identifier for province or territory.';
  window['pruid' + 'Format'] = Number('');
  
  window['prname' + 'Desc'] = 'Province or Territory Name';
  window['prname' + 'Detail'] = 'Province or Territory name';
  window['prname' + 'Format'] = Number('');
  
  window['eruid' + 'Desc'] = 'Census Economic Region ID';
  window['eruid' + 'Detail'] = 'Unique identifier for economic region';
  window['eruid' + 'Format'] = Number('');
  
  window['ername' + 'Desc'] = 'Census Economic Region name';
  window['ername' + 'Detail'] = 'Census Economic Region name';
  window['ername' + 'Format'] = Number('');
  
  window['cduid' + 'Desc'] = 'Census Division ID';
  window['cduid' + 'Detail'] = 'Unique identifier for census division';
  window['cduid' + 'Format'] = Number('');
  
  window['cdname' + 'Desc'] = 'Census Division name';
  window['cdname' + 'Detail'] = 'Census division name';
  window['cdname' + 'Format'] = Number('');
  
  window['csduid' + 'Desc'] = 'Census Subdivision ID';
  window['csduid' + 'Detail'] = 'Unique identifier for census subdivision';
  window['csduid' + 'Format'] = Number('');
  
  window['csdname' + 'Desc'] = 'Census Subdivision name';
  window['csdname' + 'Detail'] = 'Census subdivision name';
  window['csdname' + 'Format'] = Number('');
  
  window['fsauid' + 'Desc'] = 'Forward Sorting Area ID';
  window['fsauid' + 'Detail'] = 'Unique identifier for forward sorting area';
  window['fsauid' + 'Format'] = Number('');
  
  window['dauid' + 'Desc'] = 'Dissemination Area ID';
  window['dauid' + 'Detail'] = 'Unique identifier for dissemination area';
  window['dauid' + 'Format'] = Number('');
  
  window['saccode' + 'Desc'] = 'Statistical Area Classification';
  window['saccode' + 'Detail'] = '3-digit Statisical Area Classification code';
  window['saccode' + 'Format'] = Number('');
  
  window['sactype' + 'Desc'] = 'Statistical Area Classification Type';
  window['sactype' + 'Detail'] = 'The Statistical Area Classification groups census subdivisions according to whether they are a component of a census metropolitan area, a census agglomeration, a census metropolitan influenced zone or the territories.';
  window['sactype' + 'Format'] = Number('');
  
  window['landuse' + 'Desc'] = 'Land Use Class';
  window['landuse' + 'Detail'] = 'Assigned land use for the Settled Area (SAUID) based on population density, census housing characteristics and NAICS industry codes. One of residential-high, -medium, or -low density; mixed use; commercial industrial; or rural.';
  window['landuse' + 'Format'] = Number('');
  

  var map = L.map( 'map', {
    fullscreenControl: true,
    center: [ 57, -100 ],
    zoom: 4}),
    legend = L.control( { position: 'bottomright' } ),
    params = new URLSearchParams(window.location.search), // Get query paramaters
    baseUrl = "https://geo-api.stage.riskprofiler.ca/collections/opendrr_dsra_",
    eqScenario = params.get( 'scenario' ), // Scenario name
    featureProperties = 'Sauid,sCt_Res90_b0', // Limit fetched properties for performance
    scenarioProp = 'sCt_Res90_b0', // Property for popup and feature colour
    limit = 500,
    selection;
    

  L.tileLayer( '//{s}.tile.osm.org/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
	}).addTo( map );

  const geojsonLayer = L.geoJSON([], {
        style: featureStyle,
        onEachFeature: geoJsonOnEachFeature
      }).addTo( map );

  if ( eqScenario ) {

    $("#scenarios").hide();

    var scenario = eqScenario.toLowerCase(); // API uses lowercase
      geojsonUrl = baseUrl + scenario + "_indicators_s/items?lang=en_US&f=json&limit=" + limit  + '&properties=' + featureProperties,
      featureUrl = baseUrl + scenario + "_indicators_s/items/";

    // Turn scenario name into a title
    end = eqScenario.split( '_' )[ 1 ];
    title = '';
    for ( let char of end ) {
      // Add space before uppercase letters
      if ( char == char.toUpperCase() ) {
        title += ' ' + char;
      }
      // Leave lowercase as is
      else {
        title += char;
      }
    }
    mag = eqScenario[ 3 ] + '.' + eqScenario[ 5 ];
    full_name = title + ' - Magnitude ' + mag;

    // Replace generic title with scenario name
    $( '#wb-cont' ).html( full_name + ' Scenario Map' );

    // Add progress modal to map before fetching geoJSON
    $( '#map' ).before( '<div id="modal"></div>' );
    getData( geojsonUrl );

    map.on( 'fullscreenchange', function () {
      map.invalidateSize();
    });
  }
  
  // Get all geoJSON for scenario
  function getData( url ) {
    
    var nxt_lnk;

    $.getJSON( url, function ( data ) {
      
      geojsonLayer.addData( data );

      for ( var l in data.links ) {
        lnk = data.links[ l ];
        if ( lnk.rel == 'next' ) {
          nxt_lnk = lnk.href;
          break;
        }
      }
      
      // if next link continue loading data
      if ( nxt_lnk ) {
        getData( nxt_lnk );
      } else {
        // set map bounds to frame loaded features
        map.fitBounds(geojsonLayer.getBounds());
        // done with paging so remove progress
        $( '#modal' ).remove();
        // Add legend
        legend.addTo( map );
      }
    })
    .fail( function ( jqXHR, error ) {
      $( '#alert' ).show();
      $( '#modal' ).remove();
      $( '#scenarios' ).show();
    });
  }

  // Handles events for each feature
  function geoJsonOnEachFeature( feature, layer ){
    layer.bindPopup( function ( e ) {
      return L.Util.template( '<p>Residents displaced after 90 days: <strong>' + e.feature.properties.sCt_Res90_b0.toLocaleString( undefined, { maximumFractionDigits: 0 }) + '</strong></p>' );
    }).on({
      click: function( e ) {
        if ( selection ) {
          // reset style of previously selected feature
          selection.setStyle(featureStyle(selection.feature));
        }
        selection = e.target;
        selection.setStyle(selectedStyle());

        // Get geoJSON of selected feature
        $.ajax({
          method: "GET",
          tryCount : 0,
          retryLimit : 3,
          crossDomain: true,
          url: featureUrl +  selection.feature.id,
          headers: { "content-type": "application/json" }
        })

        // Displays properties of selection in a table
        .done( function ( resp ) {

          let props = resp.properties,
             string = '<table class="table table-striped table-responsive"><tr>';

          counter = 1; // Counts number of cells in table row

          for ( const key in props ) {

            mod_key = key; // Key with _b0, _r1, _le ending must be modified
            mod = '';

            if ( key.slice( -3 ) === '_b0' ) {
              mod_key = key.slice( 0, -3 );
              mod = ' (Baseline)';
            }
            else if ( key.slice( -3 ) === '_r1' ) {
              mod_key = key.slice( 0, -3 );
              mod = ' (Retrofit)';
            }
            else if ( key.slice( -3 ) === '_le' ) {
              mod_key = key.slice( 0, -3 );
              mod = ' (Seismic Upgrade)';
            }

            desc = window[ mod_key + 'Desc' ];
            detail = window[ mod_key + 'Detail' ];
            format = window[ mod_key + 'Format' ];
            value = props[ key ];

            if ( format && value ) { // Format values with set formatting
                if ( format === 444 ) {
                  value = value.toLocaleString( undefined, {style:'currency', currency:'USD'});
                }
                else if ( format === 111 ) {
                  value = value.toLocaleString( undefined, { maximumFractionDigits: 0 })
                }
                else if ( format === 555 ) {
                  value *= 100
                  value = value.toLocaleString( undefined, { maximumFractionDigits: 2 });
                  value += '%';
                }
                else if ( format < 0 ) {
                  mult = Math.abs(format);
                  rounded = Math.round( value / ( 10 ** mult )) * 10 ** mult;
                  value = rounded.toLocaleString( undefined);
                }
                else if ( format > 0 ) {
                  value = value.toLocaleString( undefined, { maximumFractionDigits: format });
                }

                string +=
                '<td class="attr"><div class="prop" title="' + detail + '">' + desc + mod + '</div><div class="val">' + value + '</div></td>';
              }
            // Leaflet info not displayed
            else if ( key === 'OBJECTID' || key === 'SHAPE_Length' || key === 'SHAPE_Area' || key === 'geom_poly' ) {
            }
            else if ( desc ) { // For properties with descriptions but null values
              string +=
                '<td class="attr"><div class="prop" title="' + detail + '">' + desc + mod + '</div><div class="val">' + value + '</div></td>';
            }
            else { // Properties with no descriptions
              string +=
                '<td class="attr"><div class="prop">' + key + '</div><div class="val">' + value + '</div></td>';
            }
            if ( counter % 3 === 0 ) {
                string += '</tr><tr>';
              }
            counter++;
          }
          string += '</tr></table>';
          // Add table to sidebar div
          $( '#sidebar' ).html( '<h3>Properties of Selected Feature</h3>' + string );
        })

        .fail( function ( error ) {
        this.tryCount++;
        if ( this.tryCount <= this.retryLimit ) {
            //try again
            $.ajax( this );
            return;
        }   
        console.log( "Doh! " + error )    
        return;
        
        });
      }
    });
  };

  function getColor( d ) {
      return d > 300  ? '#ff3b00' :
          d > 100   ? '#ff6500' :
          d > 50   ? '#ff9000' :
          d > 10   ? '#ffba00' :
                      '#fff176';
  }

  legend.onAdd = function ( map ) {

    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 10, 50, 100, 300],
        label = ' People Displaced';

    div.innerHTML = "<div style=\"padding: 3px;\"><b>People displaced after 90 days</b></div>";

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++ ) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + ( grades[i + 1] ? '&ndash;' + grades[i + 1] + label + '<br>' : '+' + label);
    }

    return div;
  };

  function featureStyle( feature ) {
    return {
        fillColor: getColor( feature.properties[ scenarioProp ] ),
        weight: 0.6,
        fillOpacity: 0.7,
        color: '#4b4d4d',
        opacity: 1
    };
  }

  function selectedStyle( feature ) {
      return {
        fillColor: 'blue',
        color: 'black',
        weight: 1,
        fillOpacity: 0.5
    };
  }

</script>

<style>
  #alert {
    display: none;
    background: rgb(220, 20, 20);
    color: white;
    padding: 5px;
  }
</style>


<div class="pagedetails">
	<div class="row">
		<div class="col-sm-6 col-md-5 col-lg-4">
			<details class="brdr-0">
				<summary class="btn btn-default text-center">Report a problem on this page</summary>
				<div class="well row"><div class="gc-rprt-prblm">
	<div class="gc-rprt-prblm-frm gc-rprt-prblm-tggl">
		<form action="#">
			<fieldset>
				<legend><span class="field-name">Please select all that apply:</span></legend>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f1">
						<input type="checkbox" name="problem1" value="Yes" id="gc-rprt-prblm-f1" />A link, button or video is not working
					</label>
					<input name="problem1" type="hidden" value="No" />
				</div>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f2">
						<input type="checkbox" name="problem2" value="Yes" id="gc-rprt-prblm-f2" />It has a spelling mistake
					</label>
					<input name="problem2" type="hidden" value="No" />
				</div>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f3">
						<input type="checkbox" name="problem3" value="Yes" id="gc-rprt-prblm-f3" />Information is missing
					</label>
					<input name="problem3" type="hidden" value="No" />
				</div>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f4">
						<input type="checkbox" name="problem4" value="Yes" id="gc-rprt-prblm-f4" />Information is outdated or wrong
					</label>
					<input name="problem4" type="hidden" value="No" />
				</div>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f5">
						<input type="checkbox" name="problem5" value="Yes" id="gc-rprt-prblm-f5" />I can't find what I'm looking for
					</label>
					<input name="problem5" type="hidden" value="No" />
				</div>
				<div class="checkbox">
					<label for="gc-rprt-prblm-f6">
						<input type="checkbox" name="problem6" value="Yes" id="gc-rprt-prblm-f6" />Other issue not in this list
					</label>
					<input name="problem6" type="hidden" value="No" />
				</div>
			</fieldset>
			<button type="submit" class="btn btn-primary wb-toggle" data-toggle='{"stateOff": "hide", "stateOn": "show", "selector": ".gc-rprt-prblm-tggl"}'>Submit</button>
		</form>
	</div>
	<div class="gc-rprt-prblm-thnk gc-rprt-prblm-tggl hide">
		<h3>Thank you for your help!</h3>
		<p>You will not receive a reply. For enquiries, please <a href="https://www.canada.ca/en/contact.html">contact us</a>.</p>
	</div>
</div>
</div>
			</details>
		</div><div class="wb-share col-sm-4 col-md-3 col-sm-offset-2 col-md-offset-4 col-lg-offset-5" data-wb-share='{"lnkClass": "btn btn-default btn-block"}'></div></div>
	<dl id="wb-dtmd">
		<dt>Date modified:</dt>
		<dd><time property="dateModified">2021-07-26</time></dd>
	</dl>
</div>

</main>

<footer id="wb-info">

	<div class="brand">
	<div class="container">
		<div class="row ">
			<nav class="col-md-9 col-lg-10 ftr-urlt-lnk">
				<h2 class="wb-inv">About this site</h2>
				<ul><li><a href="https://www.canada.ca/en/social.html">Social media</a></li>
					<li><a href="https://www.canada.ca/en/mobile.html">Mobile applications</a></li>
					<li><a href="https://www1.canada.ca/en/newsite.html">About Canada.ca</a></li>
					<li><a href="https://www.canada.ca/en/transparency/terms.html">Terms and conditions</a></li>
					<li><a href="https://www.canada.ca/en/transparency/privacy.html">Privacy</a></li></ul>
			</nav>
			<div class="col-xs-6 visible-sm visible-xs tofpg">
				<a href="#wb-cont">Top of Page <span class="glyphicon glyphicon-chevron-up"></span></a>
			</div>
			<div class="col-xs-6 col-md-3 col-lg-2 text-right">
				<img src="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/assets/wmms-blk.svg" alt="Symbol of the Government of Canada" />
			</div>
		</div>
	</div>
</div>
</footer>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha384-rY/jv8mMhqDabXSo+UCggqKtdmBfd3qC2/KvyTDNQ6PcUJXaxK1tMepoQda4g5vB" crossorigin="anonymous"></script>
<script src="https://wet-boew.github.io/wet-boew/wet-boew/js/wet-boew.min.js"></script>
<script src="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/js/theme.min.js"></script>
</body>
</html>
